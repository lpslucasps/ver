# Events used to verify if everything is in order, remove static opinion modifiers that doesn't apply anymore and other under the hood things. Usually called by on_actions/ver_on_actions.txt

namespace = vermain

# vermain.10: Transform Vassals into custom subject types. Called monthly.
country_event = {
	id = vermain.10
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		is_overlord = yes
		any_subject = {
			OR = {
				is_subject_type = vassal
				is_subject_type = subsidiary
			}
		}
	}

	immediate = {
		every_subject = {
			limit = {
				OR = {
					is_subject_type = vassal
					is_subject_type = subsidiary
				}
			}
			country_event = { id = ver.11 }
		}
	}
}

# vermain.11: Removes no longer applicable modifiers. Called monthly.
event = {
	id = vermain.11
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		# Removes Overlord Indoctrination from former Disciples and Worhsippers
		every_country = {
			limit = {
				has_modifier = ver_overlord_indoctrination
				OR = {
					NOT = { is_subject_type = verdisciple }
					NOT = { is_subject_type = verworshipper }
					is_at_war_with = overlord
				}
			}
			remove_modifier = ver_overlord_indoctrination
		}

		# Removes Demilitarized from former Autonomous Regions
		every_country = {
			limit = {
				has_modifier = ver_demilitarized
				OR = {
					NOT = { is_subject_type = verautonomous }
					is_at_war_with = overlord
				}
			}
			remove_modifier = ver_demilitarized
		}

		# Removes Military Subsidies from former Foederati
		every_country = {
			limit = {
				has_modifier = ver_military_subsidies
				OR = {
					NOT = { is_subject_type = verfoederatus }
					is_at_war_with = overlord
				}
			}
			remove_modifier = ver_military_subsidies
		}

		# Removes Puppet State from former Puppets
		every_country = {
			limit = {
				has_modifier = ver_puppet_state
				OR = {
					NOT = { is_subject_type = verpuppet }
					is_at_war_with = overlord
				}
			}
			remove_modifier = ver_puppet_state
		}

		# Removes Kobun from former Kobuns
		every_country = {
			limit = {
				has_modifier = ver_kobun_malus
				OR = {
					NOT = { is_subject_type = kobun }
					is_at_war_with = overlord
				}
			}
			remove_modifier = ver_kobun_malus
		}

		# Remove taxes from subject empires that are no longer taxed or former subject empires
		every_country = {
			limit = {
				is_country_type = default
				OR = {
					AND = {
						is_subject = yes
						overlord = { has_policy_flag = ver_no_taxation }
					}
					AND = {
						is_subject = yes
						overlord = { NOT = { has_policy_flag = ver_no_taxation } }
						is_at_war_with = overlord
					}
					is_subject = no
				}
			}
			ver_remove_overlord_taxes = yes
		}

		# Remove Parallel Processors from machine authorities without subjects
		every_country = {
			limit = {
				is_country_type = default
				has_authority = auth_machine_intelligence
				OR = {
					is_overlord = no
					NOT = { any_subject = { is_subject_type = verparallel } }
				}
			}
			ver_remove_parallel_processor_bonuses = yes
		}
	}
}

# vermain.12: Reapply modifiers. Called monthly.
event = {
	id = vermain.12
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_country = {
			limit = {
				is_subject_type = verautonomous
				NOR = {
					has_modifier = ver_demilitarized
					is_at_war_with = overlord
				}
			}
			add_modifier = { modifier = ver_demilitarized days = -1 }
		}
		every_country = {
			limit = {
				is_subject_type = verpuppet
				NOR = {
					has_modifier = ver_puppet_state
					is_at_war_with = overlord
				}
			}
			add_modifier = { modifier = ver_puppet_state days = -1 }
		}
		every_country = {
			limit = {
				is_subject_type = verkobun
				NOR = {
					has_modifier = ver_kobun_malus
					is_at_war_with = overlord
				}
			}
			add_modifier = { modifier = ver_kobun_malus days = -1 }
		}
		every_country = {
			limit = {
				OR = {
					is_subject_type = verdisciple
					is_subject_type = verworshipper
				}
				NOR = {
					has_modifier = ver_overlord_indoctrination
					is_at_war_with = overlord
				}
			}
			add_modifier = { modifier = ver_overlord_indoctrination days = -1 }
		}
	}
}

# vermain.13: Apply Parallel Processors effects (on_monthly_pulse_country)
country_event = {
	id = vermain.13
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		has_authority = auth_machine_intelligence
		is_overlord = yes
		any_subject = {	is_subject_type = verparallel }
	}

	immediate = {
		set_variable = { which = ver_total_parallel_processors value = 0 }

		every_subject = {
			limit = {
				is_subject_type = verparallel
				NOT = { is_at_war_with = overlord }
			}
			prev = { change_variable = { which = ver_total_parallel_processors value = 1 } }
		}

		# Apply bonuses
		if = {
			limit = {
				check_variable = { which = ver_total_parallel_processors value = 1 }
				NOT = { has_modifier = ver_parallel_processors_1 }
			}
			ver_remove_parallel_processor_bonuses = yes
			add_modifier = { modifier = ver_parallel_processors_1 days = -1 }
		}
		else_if = {
			limit = {
				check_variable = { which = ver_total_parallel_processors value = 2 }
				NOT = { has_modifier = ver_parallel_processors_2 }
			}
			ver_remove_parallel_processor_bonuses = yes
			add_modifier = { modifier = ver_parallel_processors_2 days = -1 }
		}
		else_if = {
			limit = {
				check_variable = { which = ver_total_parallel_processors value = 3 }
				NOT = { has_modifier = ver_parallel_processors_3 }
			}
			ver_remove_parallel_processor_bonuses = yes
			add_modifier = { modifier = ver_parallel_processors_3 days = -1 }
		}
		else_if = {
			limit = {
				check_variable = { which = ver_total_parallel_processors value >= 4 }
				NOT = { has_modifier = ver_parallel_processors_4 }
			}
			ver_remove_parallel_processor_bonuses = yes
			add_modifier = { modifier = ver_parallel_processors_4 days = -1 }
		}
		else = {
			ver_remove_parallel_processor_bonuses = yes
		}

		set_variable = { which = ver_total_parallel_processors value = 0 }
	}
}

# vermain.2: Select all countries which are taxing subjects. Called monthly.
country_event = {
	id = vermain.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		is_overlord = yes
		OR = {
			has_policy_flag = ver_light_taxes
			has_policy_flag = ver_moderate_taxes
			has_policy_flag = ver_heavy_taxes
			has_policy_flag = ver_burdensome_taxes
		}
	}

	immediate = {
		country_event = { id = vermain.20 days = 1}
	}
}

# vermain.20: Calculate aproximate total subjects trade and apply taxes. Called by vermain.2
country_event = {
	id = vermain.20
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		set_variable = { which = ver_subjects_trade value = 0 }

		# Calculate aproximate total subjects trade value
		every_subject = {
			limit = {
				NOR = {
					has_ethic = ethic_gestalt_consciousness
					is_at_war_with = overlord
				}
			}
			country_event = { id = vermain.21 }
		}

		if = {
			limit = { has_policy_flag = ver_light_taxes }
			divide_variable = { which = ver_subjects_trade value = 20 }
		}
		else_if = {
			limit = { has_policy_flag = ver_moderate_taxes }
			divide_variable = { which = ver_subjects_trade value = 10 }
		}
		else_if = {
			limit = { has_policy_flag = ver_heavy_taxes}
			divide_variable = { which = ver_subjects_trade value = 5 }
		}
		else = {
			divide_variable = { which = ver_subjects_trade value = 3.3 }
		}

		# Apply trade value bonus to the overlord capital
		country_event = { id = vermain.22 }
	}
}

# vermain.21: Calculate aproximate total trade value of all subject empires. Called by vermain.20
country_event = {
	id = vermain.21
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { capital_scope.solar_system = { trade_route_value < 5 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 1 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 10 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 5 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 25 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 10 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 50 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 25 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 75 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 50 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 100 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 75 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 125 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 100 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 150 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 125 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 175 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 150 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 200 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 175 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 225 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 200 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 250 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 225 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 275 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 250 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 300 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 275 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 350 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 300 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 400 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 350 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 450 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 400 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 450 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 600 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 700 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 600 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 800 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 700 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 900 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 800 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 1000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 900 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 1250 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 1000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 1500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 1250 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 1750 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 1500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 2000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 1750 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 2250 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 2000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 2500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 2250 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 2750 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 2500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 3000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 2750 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 3250 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 3000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 3500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 3250 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 3750 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 3500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 4000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 3750 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 4250 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 4000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 4500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 4250 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 4750 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 4500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 5000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 4500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 5500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 5000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 6000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 5500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 6500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 6000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 7000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 6500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 7500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 7000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 8000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 7500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 8500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 8000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 9000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 8500 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 9500 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 9000 }
			}
		}
		else_if = {
			limit = { capital_scope.solar_system = { trade_route_value < 10000 } }
			overlord = {
				change_variable = { which = ver_subjects_trade value = 9500 }
			}
		}
		else = {
			overlord = {
				change_variable = { which = ver_subjects_trade value = 10000 }
			}
		}
	}
}

# vermain.22: Apply modifier to overlord trade
country_event = {
	id = vermain.22
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		ver_remove_taxes_bonuses = yes

		if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 0 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 5 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_1 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 10 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_2 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 25 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_3 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 50 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_4 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 75 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_5 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 100 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_6 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 125 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_7 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 150 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_8 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 175 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_9 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 200 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_10 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 225 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_11 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 250 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_12 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 275 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_13 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 300 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_14 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 350 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_15 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 400 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_16 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 450 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_17 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_18 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 600 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_19 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 700 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_20 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 800 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_21 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 900 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_22 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 1000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_23 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 1250 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_24 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 1500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_25 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 1750 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_26 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 2000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_27 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 2250 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_28 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 2500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_29 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 2750 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_30 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 3000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_31 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 3250 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_32 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 3500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_33 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 3750 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_34 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 4000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_35 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 4250 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_36 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 4500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_37 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 4750 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_38 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 5000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_39 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 5500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_40 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 6000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_41 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 6500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_42 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 7000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_43 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 7500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_44 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 8000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_45 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 8500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_46 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 9000 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_47 days = -1 } }
		}
		else_if = {
			limit = { check_variable = { which = ver_subjects_trade value <= 9500 } }
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_48 days = -1 } }
		}
		else = {
			capital_scope = { add_modifier = { modifier = ver_subjects_taxes_49 days = -1 } }
		}
	}

	after = {
		# Reset variable to 0 after using it, so it doesn't take memmory space
		set_variable = { which = ver_subjects_trade value = 0 }
	}
}

# If the country has no more subjects, remove trade bonus. Called monthly.
event = {
	id = vermain.23
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		OR = {
			is_overlord = no
			NOT = {	any_subject = {	NOT = { is_at_war_with = overlord } } }
		}
	}

	immediate = {
		ver_remove_taxes_bonuses = yes
	}
}

# Apply taxes to any newly-acquired subject. Monthly pulse.
country_event = {
	id = vermain.24
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		is_subject = yes
		NOT = { has_ethic = ethic_gestalt_consciousness }
		overlord = {
			OR = {
				has_policy_flag = ver_light_taxes
				has_policy_flag = ver_moderate_taxes
				has_policy_flag = ver_heavy_taxes
				has_policy_flag = ver_burdensome_taxes
			}
		}
	}

	immediate = {
		ver_remove_overlord_taxes = yes
		if = {
			limit = { overlord = { has_policy_flag = ver_light_taxes } }
			add_modifier = { modifier = ver_light_overlord_taxes days = -1 }
		}
		else_if = {
			limit = { overlord = { has_policy_flag = ver_moderate_taxes } }
			add_modifier = { modifier = ver_moderate_overlord_taxes days = -1 }
		}
		else_if = {
			limit = { overlord = { has_policy_flag = ver_heavy_taxes } }
			add_modifier = { modifier = ver_heavy_overlord_taxes days = -1 }
		}
		else = {
			add_modifier = { modifier = ver_burdensome_overlord_taxes days = -1 }
		}
	}
}

# vermain.40: The Blood Tax pulse (on_five_year_pulse)
country_event = {
	id = vermain.40
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		is_overlord = yes
		any_subject = {
			OR = {
				is_subject_type = verblood
				is_subject_type = verkobun
			}
			NOT = { is_at_war_with = overlord }
		}
		NOT = { has_country_flag = ver_recent_blood_tribute }
	}

	immediate = {
		random_subject = {
			limit = {
				OR = {
					is_subject_type = verblood
					is_subject_type = verkobun
				}
			save_event_target_as = ver_blood_tributary
		}
		country_event = { id = ver.40 days = 300 random = 600 }
	}
}
